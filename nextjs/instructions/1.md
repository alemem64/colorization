# Project Specification: Nano Manana (Phase 1 - UI & Architecture Shell)

## 1\. Project Overview & Architecture

**Nano Manana** is a client-side Next.js web application for coloring and translating manga.

  * **Architecture Pattern:** **Browser-as-a-Server**. The application must operate entirely client-side. There is no backend database and no backend API processing.
  * **Goal for Phase 1:** Build the complete UI, State Management, and File Handling logic. **Do not implement the actual Google Gemini API connection yet.**
  * **Mock Logic:** Instead of calling an AI API, implement a "Mock Processor" that simulates a delay (processing time) and then marks the task as complete.
  * **Mock Download:** The download function should zip the **original** uploaded images in their **current sorted order**, renaming them sequentially (`1p.png`, `2p.png`, `3p.png`...) inside the zip file.

## 2\. Tech Stack

  * **Framework:** Next.js 14+ (App Router), TypeScript.
  * **UI Library:** `shadcn/ui` (Components), `lucide-react` (Icons).
  * **Styling:** Tailwind CSS (with strict CSS variable mapping).
  * **State Management:** `zustand` (Crucial for managing file queues and global settings).
  * **Drag & Drop (Sortable):** `@dnd-kit/core`, `@dnd-kit/sortable`, `@dnd-kit/utilities`.
  * **File Upload:** `react-dropzone`.
  * **File Processing (Client-side):** `jszip`, `file-saver`.

## 3\. Design System & Theming

### A. Color Palette (Strict CSS Variables)

Do not use arbitrary Tailwind colors. Define these variables in `styles/globals.css`.

  * **Highlight (`hl`)**: Yellow (Active/Accent state).
  * **Primary (`pri`)**: High contrast, achromatic (Black/White).
  * **Secondary (`sec`)**: Mid-tone, Bluish-Gray tint.
  * **Tertiary (`ter`)**: Low contrast, "Disabled" look.

**Required Variable Structure (Implement Light & Dark modes):**

```css
@layer base {
  :root {
    /* Primary: Clean Black/White */
    --pri-txt: #09090b;
    --pri-bg: #ffffff;
    --pri-bd: #e4e4e7;
    
    /* Secondary: Bluish Gray (Cooler tone) */
    --sec-txt: #475569;
    --sec-bg: #f8fafc; /* Very light cool gray */
    --sec-bd: #e2e8f0;

    /* Tertiary: Faint/Disabled */
    --ter-txt: #94a3b8;
    --ter-bg: #f1f5f9;
    --ter-bd: #e2e8f0;

    /* Highlight: Yellow */
    --hl-txt: #854d0e; /* Dark yellow-brown for text readability */
    --hl-bg: #fef08a; /* Light yellow */
    --hl-bd: #fde047;
    
    --bd-radius: 0.5rem;
  }

  .dark {
    /* Invert colors for Dark Mode */
    --pri-txt: #ffffff;
    --pri-bg: #09090b;
    --pri-bd: #27272a;

    --sec-txt: #94a3b8;
    --sec-bg: #1e293b; /* Dark bluish gray */
    --sec-bd: #334155;

    --ter-txt: #64748b;
    --ter-bg: #0f172a;
    --ter-bd: #1e293b;

    /* Highlight: Keep Yellow but adjust for dark bg */
    --hl-txt: #fef08a; 
    --hl-bg: #422006; /* Dark brownish yellow background */
    --hl-bd: #854d0e;
  }
}
```

### B. Internationalization (i18n)

  * Create `i18n/en.ts` containing all text strings.
  * Use a hook to consume these strings. **No hardcoded English in TSX files.**

## 4\. Component & UI Specifications

### A. Global Layout (`components/layout/`)

  * **Top Nav:**
      * **Left:**
          * "Nano Manana" Logo (Link to `/`).
          * "Colorize" Link.
          * "Translate" Link.
      * **Right:**
          * **Theme Toggle:** A button to switch between Light and Dark mode (Sun/Moon icons).

### B. Root Page (`/`)

  * **Hero:** "Colorize and translate manga with Nano Banana pro." (Use `pri-txt` for title).
  * **Navigation Cards:** Two large cards using `sec-bg` that hover to `hl-bg`.

### C. Feature Pages (`/colorize` & `/translate`)

Both pages share a similar structure.

#### 1\. File Upload View (Empty State)

  * Use `react-dropzone`.
  * Visual feedback on drag over (Change border to `hl-bd`).

#### 2\. Workspace View (Files Loaded)

**Left: Card Grid (`dnd-kit`)**

  * **Card UI:**
      * Top-left badge: Index (1, 2, 3...).
      * Bottom: Filename.
      * **Drag Handle:** The entire card should be draggable.
      * **Status Overlay:**
          * Processing: Shimmer effect.
          * Done: Overlay using `hl-bg` (with opacity) + Checkmark icon.
  * **Sorting Controls:**
      * A button to toggle sort: "Alphabetical (A-Z)" \<-\> "Alphabetical (Z-A)".
      * Updating sort must update the index numbers on the badges.

**Right: Sidebar (`components/layout/Sidebar.tsx`)**

  * **Title:** "Colorize" or "Translate".
  * **Inputs:**
      * **API Key:** Input field (type="password").
      * **Parameters:**
          * Batch Size (Slider 1-5 for Colorize, 1-16 for Translate).
          * Resolution (Slider/Select: 1K, 2K, 3K, 4K).
          * (Translate only) From/To Language inputs.
  * **Action Button:**
      * **State 1 (Idle):** "Colorize\!" / "Translate\!".
      * **State 2 (Processing):** Shows a progress bar filling up.
      * **State 3 (Done):** "Download Zip".

## 5\. Functional Logic (Mock Implementation)

### A. The "Mock" Processor

Since we are not connecting to Gemini yet, implement the `handleProcess` function in the Zustand store as follows:

1.  Iterate through the file queue.
2.  Use `setTimeout` to simulate a network delay (e.g., 500ms per batch).
3.  Update the state of files to "Done" sequentially to visualize the progress bar.

### B. Download Logic (Renaming)

When the "Download Zip" button is clicked:

1.  Use `JSZip`.
2.  Take the files from the **current state** (respecting the user's sorted order).
3.  Add them to the zip folder.
      * **Crucial:** Rename the files based on their index.
      * First file -\> `1p.png` (or original extension)
      * Second file -\> `2p.png`
      * ...
4.  Trigger download using `file-saver`.

-----

## 6\. Implementation Order

Please generate the code in this specific order:

1.  **System Setup:** `styles/globals.css` (CSS Variables) & `tailwind.config.ts`.
2.  **i18n:** `i18n/en.ts`.
3.  **Store:** `store/useAppStore.ts` (Zustand store for files, drag-drop reordering logic, and mock processing).
4.  **Components:**
      * `ThemeToggle.tsx`
      * `TopNav.tsx`
      * `Sidebar.tsx`
      * `FileCard.tsx` (with dnd-kit integration)
5.  **Pages:** `/page.tsx`, `/colorize/page.tsx`, `/translate/page.tsx`.
